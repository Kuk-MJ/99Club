# StudyGroup Day 9!

#new+375. 전주 듣고 노래 맞히기
# https://www.acmicpc.net/problem/31562

from collections import defaultdict as dd

N, M = map(int, input().split())   # 값 입력 및 변수 생성
songs = dd(list)

for _ in range(N):
    T, S, A = input().split(' ', 2)   # 노래 관련 정보 입력
    songs[A[:5]].append(S)   # 앞 3음절만 따서 이름 저장

for _ in range(M):
    B = input()
    song_cnt = len(songs[B])   # 해당 음절에 맞는 노래 개수 파악

    if song_cnt >= 2:   # 개수에 맞는 적당한 값 출력
        print('?')
    elif song_cnt:
        print(*songs[B])
    else:
        print('!')

# 얘도 해시.
# 없는 키를 참조하려 하면 자동으로 설정된 자료형에 맞춘 초기값을 할당해주는 defaultdict는 언제나 유용하다.
# 딱 비기너에 걸맞는 문제. 쉽지.
# 조금 느리긴 하지만, 지금 내 컨디션으론 그걸 따질 때가 아니다...



# 한 문제만 9시간 동안 보고 있자니 아주 죽을 맛이다.
# 오늘 챌린저 문제를 처음 읽어봤을 때, '아, 이거 트라이 쓰면 쉽겠다.' 라는 생각이 들었고,
# 클래스가 익숙하지 않았기에 클래스를 써서 구현해보기로 마음 먹은 뒤, 성공적으로 구현해 냈다.
# 트라이 특성 상 공통 접두사의 길이를 찾는 것 자체는 아주 유용했고, 
# (지금 생각해보니, 길이만 남기는 것이 아니라 아예 최장 길이의 공통 접두사를 전부 남기는 것도 괜찮았을 것 같았다... 나중에 시도해봐야지......)
# 그걸 바탕으로 한 먼저 입력된 두 최장 길이 공통 접두사를 가진 두 단어를 골라내는 것까지 아주 수월했으나...
# 한 가지 간과한게 있었다.
# 문제에선 최장 길이 공통 접두사를 가진 단어들 중 '가장 먼저 입력된 두 단어'를 출력하라고 명시했지만,
# 내 코드는 최장 길이 공통 접두사를 가진 단어들 중 '가장 먼저 쌍이 완성된 두 단어'를 출력한 것이다...
# (예를 들어, aaaaxx - bbbbyy - bbbbww - aaaazz 순으로 입력되었다면
#  문제가 의도한 정답은 aaaaxx와 aaaazz지만 내 코드는 bbbbyy와 bbbbww를 출력한다.)
# 그래서 이걸 해결하기 위해 DFS도 도입해보고 별 궁리를 다 해봤지만, 9시간이 경과하도록 해결하지 못했다.
# (DFS를 재귀 함수로 표현하는 과정에서 값이 제대로 반환되지 못해 생기는 문제 같은데, 이제 난 재귀 함수가 미워졌다.
#  디코를 보니 오늘 문제에 대해 토론하던 사람들이 있었는데, 트라이로 푸는게 아니라 브루트 포스로 풀 수 있다대...?
#  ...힌트 괜히 안 봤나...? 나 그럼 헛수고 한거야? 근데 문제를 보면 또 어딘가 허술한 문제인 것 같고... 에이씨몰라)
# 졸리고 집중력 떨어지고 도저히 안 되겠어서 미들러로 내려왔지만 얘도 안 풀리는건 마찬가지.
# (이분 그래프란 쉽게 말하면 '그래프를 두 색으로 칠할 때 연결된 중점끼리 색이 같지 않게 칠할 수 있는 그래프'를 의미하는데,
#  모든 중점이 서로 연결된 연결 그래프와 중간중간 끊긴 비연결 그래프를 동시에 신경써야 한다는걸 깨달으니 머리가 또 지끈지끈 아파왔다...)
# 그래서 비기너로 내려왔다. 그래... 이게 문제지... 게임에서 왜 '양민학살'이라는걸 하는지 몸소 깨달았다.
# 지금 이거 작성하는 것도 힘들다... 졸리고 머리가 아파...
# 남들이 그러길, 좋은 코딩 공부 방법은 1시간 정도 고민하다 답이 안 나오면 남들 코드를 보는 거라던데, 아무리 해도 난 그게 성미에 맞지 않는 것 같다.
# 내가 풀었다는 느낌이 너무 적게 들어서... 그래서 지금 이렇게 사서 고생하는 거지만.
# 어차피 다음 주는 설날이겠다, 그 때 생각하면서 계속 미뤄야겠다... 이제 타자 치기도 힘들어...



# 참고 웹사이트
1. https://greedy-min.tistory.com/6
2. 구글 검색 - 파이썬 UTF-8

# 타 레벨 문제
B. 
M. https://www.acmicpc.net/problem/1707
C. https://www.acmicpc.net/problem/2179
